--local transforms = asset.require("scene/fluxrope/fieldline_transform")
local earth_transforms = asset.require("scene/solarsystem/planets/earth/transforms")
local magnetosphere_transforms = asset.require("scene/solarsystem/planets/earth/magnetosphere/transforms_magnetosphere")
local sunTransforms = asset.require("scene/solarsystem/sun/transforms")
local propertyHelper = asset.require("util/property_helper")

local pspTransforms = asset.require("scene/parkersolarprobe/transforms")


local directory = asset.localResource("./data/")
local PythonPath = "C:\\Python310\\python.exe"
local ScriptPath = "C:\\Users\\eatoc\\OneDrive\\Documents\\My Documents\\NASA\\Flux rope file\\andreas\\main.py"
local FluxRopePath = asset.localResource("./data/2023-03-31T00-00-00-000.json")

local sunRadius = 6.957E8

local au_to_m = 1.496e+11

local keyframes = {

    ['2023-03-30T12:00:00'] = {
        Type = "StaticTranslation",
        Position = {-au_to_m/8,0,0}
    },
    ['2023-03-30T13:00:00'] = {
        Type = "StaticTranslation",
        Position = {au_to_m/8,0,0}
    },

}


local fieldlines = {
    Identifier = "andreas_tube",
    Parent = sunTransforms.SunCenter.Identifier,
     Transform = {
   --  Translation = {
   --        Type = "TimelineTranslation",
    --       ShouldInterpolate = true,
    --       Keyframes = keyframes,   
    --  },
       Rotation = {
            Type = "SpiceRotation",
            SourceFrame = "HEEQ180",
            DestinationFrame = "-96",
            FixedDateInfo = "2023-03-30T00-00-00-000",
            }
   
  },
    Renderable = {
        Type = "RenderableFluxRope",
        LineWidth = 1.0,
        SourceFolder = directory,
        FluxRopePath = FluxRopePath, 
        AlphaBlendlingEnabled = false,
        InputFileType = "Json",
        ScaleToMeters = au_to_m,
        ScriptPath =ScriptPath,
        PythonPath = PythonPath,
        PropNames =   {"scale","alpha","beta", "gamma", "delta", "epsilon"},
        InitialVals = {0.35,3.0, 0.225, 1.0, 0.85, 4.0}
    },

     GUI = {
        Name = "test",
        Path = "/test",
        Hidden = false
    }
  
}



asset.onInitialize(function ()
  openspace.addSceneGraphNode(fieldlines)

end)


asset.onDeinitialize(function ()
  openspace.removeSceneGraphNode(fieldlines)
end)

asset.export(fieldlines)

asset.meta = {
  Name = "Predictive Science Inc. Fieldlines Bastille Day",
  Version = "1.1",
  Description = "Magnetic fieldlines for the bastille day CME event",
  Author = "CCMC, Jonathan Grangien, Matthias Berg",
  URL = "https://dx.doi.org/10.3847/1538-4357/aab36d",
  License = "CC-BY"
}
